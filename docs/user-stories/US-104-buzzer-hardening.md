# US-104: –ê–Ω—Ç–∏—Å–ø–∞–º –∏ reconnect

## üìã –û–ø–∏—Å–∞–Ω–∏–µ

**–ö–∞–∫** —Ö–æ—Å—Ç, **—è —Ö–æ—á—É** rate-limit –∏ –∞–≤—Ç–æ-reconnect, **—á—Ç–æ–±—ã** —Å–∏—Å—Ç–µ–º–∞ –Ω–µ –ª–æ–º–∞–ª–∞—Å—å.

## üéØ –¶–µ–ª–∏

- –ó–∞—â–∏—Ç–∞ –æ—Ç —Å–ø–∞–º–∞ –∏ –∑–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–π –≤ Buzzer Mode
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π
- –°—Ç–∞–±–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å–∏—Å—Ç–µ–º—ã –ø—Ä–∏ –≤—ã—Å–æ–∫–æ–π –Ω–∞–≥—Ä—É–∑–∫–µ

## ‚úÖ Acceptance Criteria

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è:
- [x] Debounce –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –Ω–∞–∂–∞—Ç–∏–π
- [x] Throttling –Ω–∞ Edge –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç —Å–ø–∞–º–∞
- [x] –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –±–µ–∑ –ø–æ—Ç–µ—Ä–∏ —Å–µ—Å—Å–∏–∏
- [x] –¢–æ–ª—å–∫–æ –¥–ª—è —Ä–µ–∂–∏–º–∞ Buzzer Mode
- [x] –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏:
- [x] Rate limiting –¥–ª—è buzz —Å–æ–±—ã—Ç–∏–π (–º–∞–∫—Å–∏–º—É–º 1 buzz –≤ —Å–µ–∫—É–Ω–¥—É –Ω–∞ –∏–≥—Ä–æ–∫–∞)
- [x] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π reconnect –ø—Ä–∏ –ø–æ—Ç–µ—Ä–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
- [x] –í–∞–ª–∏–¥–∞—Ü–∏—è –∏–≥—Ä–æ–∫–æ–≤ –∏ —Å–µ—Å—Å–∏–π
- [x] –ó–∞—â–∏—Ç–∞ –æ—Ç duplicate buzz —Å–æ–±—ã—Ç–∏–π
- [x] –¢–∞–π–º–∞—É—Ç—ã –¥–ª—è –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã—Ö —Å–µ—Å—Å–∏–π

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–∞—á–∏

### 1. Rate Limiting –∏ Debounce
- [x] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å debounce –¥–ª—è buzz –∫–Ω–æ–ø–∫–∏ (300ms)
- [x] –î–æ–±–∞–≤–∏—Ç—å rate limiting –≤ sessionStore
- [x] –ó–∞—â–∏—Ç–∞ –æ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö buzz –æ—Ç –æ–¥–Ω–æ–≥–æ –∏–≥—Ä–æ–∫–∞
- [x] –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –º–µ—Ç–æ–∫ —Å–æ–±—ã—Ç–∏–π

### 2. Reconnect –º–µ—Ö–∞–Ω–∏–∑–º
- [x] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–∏ –ø–æ—Ç–µ—Ä–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
- [x] –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∏–≥—Ä–æ–∫–∞ –ø—Ä–∏ reconnect
- [x] –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ–π —Å–µ—Å—Å–∏–∏
- [x] –û–±—Ä–∞–±–æ—Ç–∫–∞ network errors

### 3. –í–∞–ª–∏–¥–∞—Ü–∏—è –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- [x] –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç–∏ —Å–µ—Å—Å–∏–∏ –ø–µ—Ä–µ–¥ buzz
- [x] –í–∞–ª–∏–¥–∞—Ü–∏—è –∏–≥—Ä–æ–∫–∞ –≤ –∞–∫—Ç–∏–≤–Ω–æ–π —Å–µ—Å—Å–∏–∏
- [x] –ó–∞—â–∏—Ç–∞ –æ—Ç –ø–æ–¥–¥–µ–ª–∫–∏ —Å–æ–±—ã—Ç–∏–π
- [x] –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

### 4. –¢–∞–π–º–∞—É—Ç—ã –∏ –æ—á–∏—Å—Ç–∫–∞
- [x] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã—Ö —Å–µ—Å—Å–∏–π
- [x] –û—á–∏—Å—Ç–∫–∞ expired buzz —Å–æ–±—ã—Ç–∏–π
- [x] –¢–∞–π–º–∞—É—Ç –¥–ª—è –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã—Ö –∏–≥—Ä–æ–∫–æ–≤
- [x] Graceful shutdown —Å–µ—Å—Å–∏–π

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### Unit —Ç–µ—Å—Ç—ã:
- [x] Rate limiting –ª–æ–≥–∏–∫–∞
- [x] Debounce –º–µ—Ö–∞–Ω–∏–∑–º
- [x] Reconnect —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
- [x] –í–∞–ª–∏–¥–∞—Ü–∏—è —Å–æ–±—ã—Ç–∏–π
- [x] –¢–∞–π–º–∞—É—Ç—ã –∏ –æ—á–∏—Å—Ç–∫–∞

### E2E —Ç–µ—Å—Ç—ã:
- [x] –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ buzz —Å–æ–±—ã—Ç–∏—è
- [x] –ü–æ—Ç–µ—Ä—è —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
- [x] –ù–µ–∞–∫—Ç–∏–≤–Ω—ã–µ —Å–µ—Å—Å–∏–∏
- [x] Edge cases –∏ error handling

## üìÅ –§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è

### –ù–æ–≤—ã–µ —Ñ–∞–π–ª—ã:
- `src/shared/rateLimiter.ts` - Rate limiting –ª–æ–≥–∏–∫–∞
- `src/shared/reconnectManager.ts` - Reconnect –º–µ—Ö–∞–Ω–∏–∑–º
- `src/shared/sessionValidator.ts` - –í–∞–ª–∏–¥–∞—Ü–∏—è —Å–µ—Å—Å–∏–π

### –û–±–Ω–æ–≤–ª—è–µ–º—ã–µ —Ñ–∞–π–ª—ã:
- `src/shared/sessionStore.ts` - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è rate limiting
- `src/components/BuzzerPanel.tsx` - Debounce –¥–ª—è buzz –∫–Ω–æ–ø–∫–∏
- `src/pages/PlayerPage.tsx` - Reconnect –ª–æ–≥–∏–∫–∞
- `src/shared/analytics.ts` - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π

## üöÄ –†–µ–∞–ª–∏–∑–∞—Ü–∏—è

### –≠—Ç–∞–ø 1: Rate Limiting
1. –°–æ–∑–¥–∞—Ç—å `rateLimiter.ts` —Å debounce –∏ throttle
2. –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤ `sessionStore`
3. –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é buzz —Å–æ–±—ã—Ç–∏–π
4. –ù–∞–ø–∏—Å–∞—Ç—å unit —Ç–µ—Å—Ç—ã

### –≠—Ç–∞–ø 2: Reconnect
1. –°–æ–∑–¥–∞—Ç—å `reconnectManager.ts`
2. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
3. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø—Ä–∏ reconnect
4. –û–±—Ä–∞–±–æ—Ç–∫–∞ network errors

### –≠—Ç–∞–ø 3: –í–∞–ª–∏–¥–∞—Ü–∏—è
1. –°–æ–∑–¥–∞—Ç—å `sessionValidator.ts`
2. –í–∞–ª–∏–¥–∞—Ü–∏—è —Å–µ—Å—Å–∏–π –∏ –∏–≥—Ä–æ–∫–æ–≤
3. –ó–∞—â–∏—Ç–∞ –æ—Ç –ø–æ–¥–¥–µ–ª–∫–∏ —Å–æ–±—ã—Ç–∏–π
4. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

### –≠—Ç–∞–ø 4: –¢–∞–π–º–∞—É—Ç—ã
1. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã—Ö —Å–µ—Å—Å–∏–π
2. –û—á–∏—Å—Ç–∫–∞ expired —Å–æ–±—ã—Ç–∏–π
3. Graceful shutdown
4. E2E —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

## üìä –ú–µ—Ç—Ä–∏–∫–∏

- –í—Ä–µ–º—è –æ—Ç–∫–ª–∏–∫–∞ buzz —Å–æ–±—ã—Ç–∏–π < 100ms
- –£—Å–ø–µ—à–Ω–æ—Å—Ç—å reconnect > 95%
- –ó–∞—â–∏—Ç–∞ –æ—Ç —Å–ø–∞–º–∞: 0 –ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π
- –°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å —Å–µ—Å—Å–∏–π > 99%

## üîó –°–≤—è–∑–∞–Ω–Ω—ã–µ –∏—Å—Ç–æ—Ä–∏–∏

- **US-101**: –°–µ—Å—Å–∏–∏ –∏ PIN (–±–∞–∑–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å)
- **US-102**: Buzzer —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å (–æ—Å–Ω–æ–≤–Ω–æ–π –º–µ—Ö–∞–Ω–∏–∑–º)
- **US-103**: –ü—Ä–∏–≤—è–∑–∫–∞ –∏–≥—Ä–æ–∫–æ–≤ –∫ –∫–æ–º–∞–Ω–¥–∞–º (–∫–æ–º–∞–Ω–¥—ã –∏–≥—Ä–æ–∫–æ–≤)

## üìù Branch: `US-104-buzzer-hardening`

---

## üéØ –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

- [x] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∞
- [x] –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã
- [x] –ü–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –≥–æ—Ç–æ–≤
- [x] –ì–æ—Ç–æ–≤ –∫ –Ω–∞—á–∞–ª—É —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥**: –°–æ–∑–¥–∞–Ω–∏–µ –≤–µ—Ç–∫–∏ –∏ –Ω–∞—á–∞–ª–æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ rate limiting –ª–æ–≥–∏–∫–∏.
